# Image Captioning

This project implements an image captioning algorithm using k-Nearest Neighbors (KNN). The MS COCO 2014 validation dataset is used and Faiss library is leveraged for efficient nearest neighbor computation.

## Overview

The goal is to generate captions for images by finding the k-nearest images in the dataset and using a weighted sum of the captions from the nearest neighbors to create a query vector. The final predicted caption is selected as the one closest to this query vector.

### Key Features
- **Dataset:** MS COCO 2014 (validation set only)
- **Embeddings:** Image and caption embeddings extracted from the CLIP model.
- **KNN with Faiss:** Efficient nearest neighbor computation using Faiss library.
- **Evaluation Metric:** BLEU score for measuring caption prediction accuracy.

## Algorithm

1. **Data Preparation:**
   - Extract image and caption embeddings using the CLIP model.
   - The captions are derived from the MS COCO 2014 validation set (5 captions per image).

2. **K-Nearest Neighbor Search:**
   - For each image in the test set, find its k-nearest images in the training set using Faiss.
   - Compute the query vector as the weighted sum of the nearest images' captions.

3. **Caption Prediction:**
   - The predicted caption is the one closest to the query vector among the k-nearest captions.
   
4. **Evaluation:** 
   - Calculate BLEU scores to evaluate the accuracy of the predicted captions.

5. **Visualization:**
   - Display five random images from the test set alongside their ground truth captions and predicted captions.

## Working

- The notebook displays **five images** from the test dataset.
- For each image, the ground truth captions are shown along with the predicted caption generated by the KNN algorithm.
- The BLEU score is computed to evaluate how closely the predicted captions match the actual captions.

## Execution

- Run this notebook in Jupyter and execute all cells.
- The notebook will also download the COCO dataset.
- **Note**: The notebook accesses the COCO dataset through a mounted Google Drive. Modify the paths to point to where the COCO dataset is available.
